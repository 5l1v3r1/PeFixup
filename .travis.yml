dist: bionic
language: python
cache: pip
env:
  global:
    - USERNAME=obscuritylabs
    - IMAGE=pefixup
  
python:
  - '3.6'
  - '3.7'
  - '3.7-dev'
  - '3.8-dev'
  - 'nightly'

before_install:
  - sudo apt-get install build-essential libffi-dev libfuzzy-dev ssdeep

install:
  - pip install -r requirements.txt

script:
  - ls
 # - pytest

before_deploy:
  - echo "$DOCKER_PASSWORD" | docker login --username "$DOCKER_USER" --password-stdin

deploy:
  # deploy development to docker hub
  - provider: script
    script: 
      - bash ./scripts/release_docker.sh
    on:
      branch: development

  # deploy master to docker hub
  - provider: script
    script: 
      - bash ./scripts/release_docker.sh
    on:
      branch: master
